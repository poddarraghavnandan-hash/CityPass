
> @citypass/worker@1.0.0 dev C:\Users\ragha\citypass\apps\worker
> tsx watch src/index.ts

Typesense module not available, search indexing disabled
[dotenv@17.2.3] injecting env (48) from ..\..\.env -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 48 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T02:04:09.025Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T02:04:09.043Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T02:04:09.045Z] Running     at C:\Users\ragha\citypass\node_modules\.pnpm\tsx@4.20.6\node_modules\tsx\dist\register-D46fvsV_.cjs:3:1542
    at resolveTsPaths (C:\Users\ragha\citypass\node_modules\.pnpm\tsx@4.20.6\node_modules\tsx\dist\register-D46fvsV_.cjs:4:760)
    at C:\Users\ragha\citypass\node_modules\.pnpm\tsx@4.20.6\node_modules\tsx\dist\register-D46fvsV_.cjs:4:1102 {
  code: 'ERR_PACKAGE_PATH_NOT_EXPORTED'
}

Node.js v24.11.0
...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T02:04:09.079Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763345049393, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T02:04:09.394Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763345049393, routers=[], readers=[], writers=[]]
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for New York...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
âœ… [2025-11-17T02:04:10.629Z] Job completed: ingestion-queue
   Result: { processed: 0 }
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
Retry 2/3 after 4000ms...
âœ… [2025-11-17T02:04:12.906Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“¦ Scraped 0 total events for New York
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
âŒ Error scraping New York: 
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
Invalid `prisma.event.findMany()` invocation in
        ?   subtitle?: StringNullableFilter | String | Null,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   description?: StringNullableFilter | String | Null,

        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
  173 if (skipDuplicates) {
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
  174   // Check for existing events by URL hash
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
â†’ 176   const existing = await prisma.event.findMany({
        ?   currency?: StringNullableFilter | String | Null,
          where: {
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
            urlHash: {
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
            ~~~~~~~
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
              in: []
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   OR?: EventWhereInput[],
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
          },
          select: {
            id: true,
            urlHash: true,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
            contentHash: true
          }
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        })
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,

        ?   description?: StringNullableFilter | String | Null,
Unknown argument `urlHash`. Available options are marked with ?.
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,

ðŸŒ† Scraping Los Angeles from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for Los Angeles
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
âŒ Apify Meetup error: Actor with this name was not found
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
        ?   OR?: EventWhereInput[],
âŒ Error scraping Los Angeles: 
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
Invalid `prisma.event.findMany()` invocation in
        ?   createdAt?: DateTimeFilter | DateTime,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
            urlHash: {
            ~~~~~~~
        ?   venueName?: StringNullableFilter | String | Null,
              in: []
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
            },
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   OR?: EventWhereInput[],
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   accessibility?: StringNullableListFilter,
        ?   id?: StringFilter | String,
        ?   viewCount?: IntFilter | Int,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   viewCount24h?: IntFilter | Int,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   sourceUrl?: StringFilter | String,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   title?: StringFilter | String,
          select: {
            id: true,
        ?   city?: StringFilter | String,
            urlHash: true,
            contentHash: true
        ?   startTime?: DateTimeFilter | DateTime,
          }
        ?   subtitle?: StringNullableFilter | String | Null,
        })

        ?   description?: StringNullableFilter | String | Null,
Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping San Francisco from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for San Francisco...
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for San Francisco
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
âŒ Error scraping San Francisco: 
Invalid `prisma.event.findMany()` invocation in

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],

        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
  173 if (skipDuplicates) {
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
          where: {
            urlHash: {
            ~~~~~~~
        ?   viewCount24h?: IntFilter | Int,
              in: []
        ?   saveCount?: IntFilter | Int,
            },
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   checksum?: StringFilter | String,
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   id?: StringFilter | String,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
          select: {
        ?   city?: StringFilter | String,
            id: true,
            urlHash: true,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
            contentHash: true
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping Chicago from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for Chicago...
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“¦ Scraped 0 total events for Chicago
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
âŒ Error scraping Chicago: 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
  174   // Check for existing events by URL hash
              in: []
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
            },
          where: {
            urlHash: {
            ~~~~~~~
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
              in: []
            },
        ?   startTime?: DateTimeFilter | DateTime,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   id?: StringFilter | String,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   viewCount24h?: IntFilter | Int,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   saveCount?: IntFilter | Int,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   saveCount24h?: IntFilter | Int,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   shareCount?: IntFilter | Int,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   currency?: StringNullableFilter | String | Null,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
          },
          select: {
        ?   accessibility?: StringNullableListFilter,
            id: true,
            urlHash: true,
            contentHash: true
          }
        })
        ?   viewCount?: IntFilter | Int,

Unknown argument `urlHash`. Available options are marked with ?.
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 7729ms
âœ… [2025-11-17T02:04:16.761Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}

ðŸš€ [2025-11-17T02:05:09.051Z] Running job: ingestion-queue
âœ… [2025-11-17T02:05:09.647Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:06:09.108Z] Running job: ingestion-queue
âœ… [2025-11-17T02:06:09.325Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:07:09.121Z] Running job: ingestion-queue
âœ… [2025-11-17T02:07:09.324Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:08:09.124Z] Running job: ingestion-queue
âœ… [2025-11-17T02:08:11.150Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:09:09.132Z] Running job: ingestion-queue
âœ… [2025-11-17T02:09:09.346Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:10:09.145Z] Running job: ingestion-queue
âœ… [2025-11-17T02:10:10.441Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:11:09.148Z] Running job: ingestion-queue
âœ… [2025-11-17T02:11:09.371Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:12:09.158Z] Running job: ingestion-queue
âœ… [2025-11-17T02:12:09.463Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:13:09.166Z] Running job: ingestion-queue
âœ… [2025-11-17T02:13:09.387Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:14:09.062Z] Running job: seed-events

ðŸš€ [2025-11-17T02:14:09.176Z] Running job: ingestion-queue
âœ… [2025-11-17T02:14:10.373Z] Job completed: ingestion-queue
   Result: { processed: 0 }
âœ… [2025-11-17T02:14:11.124Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }

ðŸš€ [2025-11-17T02:15:09.186Z] Running job: ingestion-queue
âœ… [2025-11-17T02:15:09.422Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:16:09.195Z] Running job: ingestion-queue
âœ… [2025-11-17T02:16:10.419Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:17:09.202Z] Running job: ingestion-queue
prisma:error 
Invalid `prisma.ingestionRequest.findFirst()` invocation in
C:\Users\ragha\citypass\apps\worker\src\ingestionQueueJob.ts:45:49

  42 }
  43 
  44 async function claimNextRequest() {
â†’ 45   const request = await prisma.ingestionRequest.findFirst(
Timed out fetching a new connection from the connection pool. More info: http://pris.ly/d/connection-pool (Current connection pool timeout: 10, connection limit: 5)
âŒ [2025-11-17T02:17:19.256Z] Job failed: ingestion-queue
   Error: 
Invalid `prisma.ingestionRequest.findFirst()` invocation in
C:\Users\ragha\citypass\apps\worker\src\ingestionQueueJob.ts:45:49

  42 }
  43 
  44 async function claimNextRequest() {
â†’ 45   const request = await prisma.ingestionRequest.findFirst(
Timed out fetching a new connection from the connection pool. More info: http://pris.ly/d/connection-pool (Current connection pool timeout: 10, connection limit: 5)
prisma:error Error in PostgreSQL connection: Error { kind: Io, cause: Some(Os { code: 10054, kind: ConnectionReset, message: "An existing connection was forcibly closed by the remote host." }) }
prisma:error Error in PostgreSQL connection: Error { kind: Io, cause: Some(Os { code: 10054, kind: ConnectionReset, message: "An existing connection was forcibly closed by the remote host." }) }
prisma:error Error in PostgreSQL connection: Error { kind: Io, cause: Some(Os { code: 10054, kind: ConnectionReset, message: "An existing connection was forcibly closed by the remote host." }) }

ðŸš€ [2025-11-17T02:18:09.206Z] Running job: ingestion-queue
âœ… [2025-11-17T02:18:10.190Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:19:09.069Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
âŒ [2025-11-17T02:19:09.101Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')

ðŸš€ [2025-11-17T02:19:09.213Z] Running job: ingestion-queue
âœ… [2025-11-17T02:19:09.418Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:20:09.214Z] Running job: ingestion-queue
âœ… [2025-11-17T02:20:09.411Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:21:09.226Z] Running job: ingestion-queue
âœ… [2025-11-17T02:21:09.409Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:22:09.226Z] Running job: ingestion-queue
âœ… [2025-11-17T02:22:09.421Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:23:09.237Z] Running job: ingestion-queue
âœ… [2025-11-17T02:23:09.416Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:24:09.067Z] Running job: seed-events

ðŸš€ [2025-11-17T02:24:09.250Z] Running job: ingestion-queue
âŒ [2025-11-17T02:24:11.052Z] Job failed: ingestion-queue
prisma:error 
Invalid `prisma.ingestionRequest.findFirst()` invocation in
C:\Users\ragha\citypass\apps\worker\src\ingestionQueueJob.ts:45:49
   Error: 

  42 }
  43 
  44 async function claimNextRequest() {
â†’ 45   const request = await prisma.ingestionRequest.findFirst(
Can't reach database server at `eoabuyvlsakqkuqtkwxo.db.us-west-2.nhost.run:5432`
Invalid `prisma.ingestionRequest.findFirst()` invocation in

Please make sure your database server is running at `eoabuyvlsakqkuqtkwxo.db.us-west-2.nhost.run:5432`.
prisma:error 
Invalid `prisma.event.count()` invocation in
C:\Users\ragha\citypass\apps\worker\src\ingestionQueueJob.ts:45:49

C:\Users\ragha\citypass\apps\worker\src\seedJob.ts:31:46

  28 const now = new Date();
  29 
  30 for (const [city, seeds] of Object.entries(SEED_EVENTS_BY_CITY)) {
  42 }
â†’ 31   const upcomingCount = await prisma.event.count(
  43 
  44 async function claimNextRequest() {
â†’ 45   const request = await prisma.ingestionRequest.findFirst(
Can't reach database server at `eoabuyvlsakqkuqtkwxo.db.us-west-2.nhost.run:5432`

Can't reach database server at `eoabuyvlsakqkuqtkwxo.db.us-west-2.nhost.run:5432`
Please make sure your database server is running at `eoabuyvlsakqkuqtkwxo.db.us-west-2.nhost.run:5432`.

Please make sure your database server is running at `eoabuyvlsakqkuqtkwxo.db.us-west-2.nhost.run:5432`.
âŒ [2025-11-17T02:24:11.059Z] Job failed: seed-events
   Error: 
Invalid `prisma.event.count()` invocation in
C:\Users\ragha\citypass\apps\worker\src\seedJob.ts:31:46

  28 const now = new Date();
  29 
  30 for (const [city, seeds] of Object.entries(SEED_EVENTS_BY_CITY)) {
â†’ 31   const upcomingCount = await prisma.event.count(
Can't reach database server at `eoabuyvlsakqkuqtkwxo.db.us-west-2.nhost.run:5432`

Please make sure your database server is running at `eoabuyvlsakqkuqtkwxo.db.us-west-2.nhost.run:5432`.

ðŸš€ [2025-11-17T02:25:09.252Z] Running job: ingestion-queue
âœ… [2025-11-17T02:25:10.479Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:26:09.268Z] Running job: ingestion-queue
âœ… [2025-11-17T02:26:09.490Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:27:09.279Z] Running job: ingestion-queue
âœ… [2025-11-17T02:27:09.510Z] Job completed: ingestion-queue
   Result: { processed: 0 }
9:27:59 PM [tsx] unlink in ./..\..\node_modules\.pnpm\@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3\node_modules\.prisma\client\default.js Restarting...
Typesense module not available, search indexing disabled
c[dotenv@17.2.3] injecting env (48) from ..\..\.env -- tip: ðŸ‘¥ sync secrets across teammates & machines: https://dotenvx.com/ops
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 48 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T02:29:06.761Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T02:29:06.774Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T02:29:06.777Z] Running job: ingestion-queue
  âœ“ Scheduled: ingestion-queue (every 60s)

ðŸš€ [2025-11-17T02:29:06.779Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
  âœ“ Scheduled: social-embed-index (every 900s)

ðŸš€ [2025-11-17T02:29:06.780Z] Running job: graph-similarity-refresh
ðŸ”„ Starting similarity edge refresh...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T02:29:06.817Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763346547045, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T02:29:07.046Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763346547045, routers=[], readers=[], writers=[]]
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for New York...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
Retry 2/3 after 4000ms...
âœ… [2025-11-17T02:29:09.290Z] Job completed: ingestion-queue
   Result: { processed: 0 }
âœ… [2025-11-17T02:29:10.894Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
ðŸ“¦ Scraped 0 total events for New York
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
âŒ Error scraping New York: 
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
  173 if (skipDuplicates) {
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
  174   // Check for existing events by URL hash
        ?   OR?: EventWhereInput[],
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
        ?   NOT?: EventWhereInput | EventWhereInput[],
            urlHash: {
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
            ~~~~~~~
        ?   updatedAt?: DateTimeFilter | DateTime,
              in: []
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
            },
        ?   city?: StringFilter | String,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   startTime?: DateTimeFilter | DateTime,
        ?   OR?: EventWhereInput[],
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   clickCount?: IntFilter | Int,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   saveCount24h?: IntFilter | Int,
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,

        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
Unknown argument `urlHash`. Available options are marked with ?.
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,

ðŸŒ† Scraping Los Angeles from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for Los Angeles
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
âŒ Error scraping Los Angeles: 
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
            urlHash: {

            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
  173 if (skipDuplicates) {
        ?   id?: StringFilter | String,
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
â†’ 176   const existing = await prisma.event.findMany({
          where: {
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
            urlHash: {
            ~~~~~~~
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   sourceUrl?: StringFilter | String,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   viewCount24h?: IntFilter | Int,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
          },
          select: {
            id: true,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
            urlHash: true,
            contentHash: true
          }
        ?   priceMax?: FloatNullableFilter | Float | Null,
        })

Unknown argument `urlHash`. Available options are marked with ?.

        ?   currency?: StringNullableFilter | String | Null,
ðŸŒ† Scraping San Francisco from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for San Francisco...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for San Francisco
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“Š Normalized 0/0 events
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

âŒ Error scraping San Francisco: 
Invalid `prisma.event.findMany()` invocation in
  173 if (skipDuplicates) {
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);

â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
  173 if (skipDuplicates) {
              in: []
  174   // Check for existing events by URL hash
            },
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
â†’ 176   const existing = await prisma.event.findMany({
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
          where: {
            urlHash: {
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
            ~~~~~~~
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
              in: []
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
            },
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   sourceUrl?: StringFilter | String,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   viewCount?: IntFilter | Int,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   saveCount24h?: IntFilter | Int,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
            id: true,
        ?   tags?: StringNullableListFilter,
            urlHash: true,
            contentHash: true
          }
        ?   imageUrl?: StringNullableFilter | String | Null,
        })

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping Chicago from 2 sources...
        ?   bookingUrl?: StringNullableFilter | String | Null,
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for Chicago...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for Chicago
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“Š Normalized 0/0 events
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
prisma:error 
Invalid `prisma.event.findMany()` invocation in
âŒ Error scraping Chicago: 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41


  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
              in: []
            },
            ~~~~~~~
        ?   AND?: EventWhereInput | EventWhereInput[],
              in: []
        ?   OR?: EventWhereInput[],
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   title?: StringFilter | String,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   city?: StringFilter | String,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   description?: StringNullableFilter | String | Null,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   saveCount24h?: IntFilter | Int,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 7671ms
âœ… [2025-11-17T02:29:14.435Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}

ðŸš€ [2025-11-17T02:30:06.780Z] Running job: ingestion-queue
âœ… [2025-11-17T02:30:13.094Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:31:06.796Z] Running job: ingestion-queue
âœ… [2025-11-17T02:31:07.041Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:32:06.808Z] Running job: ingestion-queue
âœ… [2025-11-17T02:32:07.023Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:33:06.813Z] Running job: ingestion-queue
âœ… [2025-11-17T02:33:07.694Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:34:06.858Z] Running job: ingestion-queue
âœ… [2025-11-17T02:34:07.140Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:35:06.868Z] Running job: ingestion-queue
âœ… [2025-11-17T02:35:08.130Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:36:06.881Z] Running job: ingestion-queue
âœ… [2025-11-17T02:36:07.117Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:37:06.889Z] Running job: ingestion-queue
âœ… [2025-11-17T02:37:07.113Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:38:06.895Z] Running job: ingestion-queue
âœ… [2025-11-17T02:38:09.020Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:39:06.819Z] Running job: seed-events

ðŸš€ [2025-11-17T02:39:11.662Z] Running job: ingestion-queue
âœ… [2025-11-17T02:39:12.766Z] Job completed: ingestion-queue
   Result: { processed: 0 }
âœ… [2025-11-17T02:39:17.517Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
9:39:46 PM [tsx] change in ./..\..\node_modules\.pnpm\@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3\node_modules\.prisma\client\index.js Restarting...
c9:39:46 PM [tsx] change in ./..\..\node_modules\.pnpm\@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3\node_modules\.prisma\client\index.js Restarting...
Typesense module not available, search indexing disabled
c[dotenv@17.2.3] injecting env (48) from ..\..\.env -- tip: ðŸ”„ add secrets lifecycle management: https://dotenvx.com/ops
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 48 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T02:41:08.552Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T02:41:08.567Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T02:41:08.569Z] Running job: ingestion-queue
  âœ“ Scheduled: ingestion-queue (every 60s)

ðŸš€ [2025-11-17T02:41:08.571Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
  âœ“ Scheduled: social-embed-index (every 900s)

ðŸš€ [2025-11-17T02:41:08.572Z] Running job: graph-similarity-refresh
ðŸ”„ Starting similarity edge refresh...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T02:41:08.600Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763347268855, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T02:41:08.857Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763347268855, routers=[], readers=[], writers=[]]
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for New York...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
âœ… [2025-11-17T02:41:10.171Z] Job completed: ingestion-queue
   Result: { processed: 0 }
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
Retry 2/3 after 4000ms...
âœ… [2025-11-17T02:41:13.015Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
ðŸ“¦ Scraped 0 total events for New York
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
âŒ Error scraping New York: 
Invalid `prisma.event.findMany()` invocation in
        ?   OR?: EventWhereInput[],
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   NOT?: EventWhereInput | EventWhereInput[],

  173 if (skipDuplicates) {
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
â†’ 176   const existing = await prisma.event.findMany({
        ?   startTime?: DateTimeFilter | DateTime,
          where: {
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
            urlHash: {
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
            ~~~~~~~
              in: []
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
            },
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   id?: StringFilter | String,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   title?: StringFilter | String,
        ?   saveCount24h?: IntFilter | Int,
        ?   city?: StringFilter | String,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
            contentHash: true
        ?   lat?: FloatNullableFilter | Float | Null,
          }
        ?   lon?: FloatNullableFilter | Float | Null,
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,

ðŸŒ† Scraping Los Angeles from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“¦ Scraped 0 total events for Los Angeles
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
âŒ Error scraping Los Angeles: 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in

C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
  173 if (skipDuplicates) {

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
  174   // Check for existing events by URL hash
â†’ 176   const existing = await prisma.event.findMany({
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
          where: {
        ?   AND?: EventWhereInput | EventWhereInput[],
            urlHash: {
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
            ~~~~~~~
        ?   subtitle?: StringNullableFilter | String | Null,
              in: []
            },
        ?   description?: StringNullableFilter | String | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   id?: StringFilter | String,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   sourceUrl?: StringFilter | String,
        ?   accessibility?: StringNullableListFilter,
        ?   title?: StringFilter | String,
        ?   viewCount?: IntFilter | Int,
        ?   city?: StringFilter | String,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,

        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
ðŸŒ† Scraping San Francisco from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for San Francisco...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for San Francisco
ðŸ“Š Normalized 0/0 events
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
âŒ Error scraping San Francisco: 
prisma:error 
Invalid `prisma.event.findMany()` invocation in
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
  173 if (skipDuplicates) {

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
  174   // Check for existing events by URL hash
â†’ 176   const existing = await prisma.event.findMany({
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
          where: {
              in: []
            urlHash: {
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
            ~~~~~~~
              in: []
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   city?: StringFilter | String,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })
        ?   description?: StringNullableFilter | String | Null,

        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping Chicago from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ¤ Apify: Scraping Meetup for Chicago...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for Chicago
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“Š Normalized 0/0 events
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
âŒ Error scraping Chicago: 

Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
  173 if (skipDuplicates) {

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
â†’ 176   const existing = await prisma.event.findMany({
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
          where: {
            urlHash: {
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
            ~~~~~~~
              in: []
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   city?: StringFilter | String,
        ?   OR?: EventWhereInput[],
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   id?: StringFilter | String,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   saveCount?: IntFilter | Int,
        ?   title?: StringFilter | String,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
            urlHash: true,
        ?   address?: StringNullableFilter | String | Null,
            contentHash: true
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
          }
        })

        ?   lon?: FloatNullableFilter | Float | Null,
Unknown argument `urlHash`. Available options are marked with ?.
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 8129ms
âœ… [2025-11-17T02:41:16.686Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}

ðŸš€ [2025-11-17T02:42:08.740Z] Running job: ingestion-queue
âœ… [2025-11-17T02:42:10.535Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:43:08.583Z] Running job: ingestion-queue
âœ… [2025-11-17T02:43:12.544Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:44:08.587Z] Running job: ingestion-queue
âœ… [2025-11-17T02:44:08.800Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:45:08.600Z] Running job: ingestion-queue
âœ… [2025-11-17T02:45:08.833Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:46:08.600Z] Running job: ingestion-queue
âœ… [2025-11-17T02:46:08.809Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:47:08.604Z] Running job: ingestion-queue
âœ… [2025-11-17T02:47:09.822Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:48:08.613Z] Running job: ingestion-queue
âœ… [2025-11-17T02:48:08.844Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:49:08.617Z] Running job: ingestion-queue
âœ… [2025-11-17T02:49:08.831Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:50:08.629Z] Running job: ingestion-queue
âœ… [2025-11-17T02:50:08.889Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:51:08.583Z] Running job: seed-events

ðŸš€ [2025-11-17T02:51:08.634Z] Running job: ingestion-queue
âœ… [2025-11-17T02:51:09.759Z] Job completed: ingestion-queue
   Result: { processed: 0 }
âœ… [2025-11-17T02:51:10.370Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }

ðŸš€ [2025-11-17T02:52:08.648Z] Running job: ingestion-queue
âœ… [2025-11-17T02:52:08.858Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:53:08.658Z] Running job: ingestion-queue
âœ… [2025-11-17T02:53:09.779Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:54:08.664Z] Running job: ingestion-queue
âœ… [2025-11-17T02:54:08.947Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:55:08.727Z] Running job: ingestion-queue
âœ… [2025-11-17T02:55:08.987Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:56:08.580Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
âŒ [2025-11-17T02:56:08.614Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')

ðŸš€ [2025-11-17T02:56:08.747Z] Running job: ingestion-queue
âœ… [2025-11-17T02:56:08.954Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:57:08.754Z] Running job: ingestion-queue
âœ… [2025-11-17T02:57:08.957Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:58:08.763Z] Running job: ingestion-queue
âœ… [2025-11-17T02:58:09.461Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T02:59:08.765Z] Running job: ingestion-queue
âœ… [2025-11-17T02:59:09.934Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:00:08.787Z] Running job: ingestion-queue
âœ… [2025-11-17T03:00:09.053Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:01:08.626Z] Running job: seed-events
10:01:08 PM [tsx] change in ./src\seedData.ts Restarting...
Typesense module not available, search indexing disabled
c[dotenv@17.2.3] injecting env (52) from ..\..\.env -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 52 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T03:01:49.473Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T03:01:49.497Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T03:01:49.504Z] Running job: ingestion-queue
  âœ“ Scheduled: ingestion-queue (every 60s)

ðŸš€ [2025-11-17T03:01:49.514Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
  âœ“ Scheduled: social-embed-index (every 900s)

ðŸš€ [2025-11-17T03:01:49.518Z] Running job: graph-similarity-refresh
ðŸ”„ Starting similarity edge refresh...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T03:01:49.576Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763348509880, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T03:01:49.881Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763348509880, routers=[], readers=[], writers=[]]
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
ðŸ¤ Apify: Scraping Meetup for New York...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
âœ… [2025-11-17T03:01:51.066Z] Job completed: ingestion-queue
   Result: { processed: 0 }
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
Retry 2/3 after 4000ms...
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“¦ Scraped 0 total events for New York
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
âŒ Error scraping New York: 
Invalid `prisma.event.findMany()` invocation in
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
â†’ 176   const existing = await prisma.event.findMany({
        ?   viewCount24h?: IntFilter | Int,
          where: {
        ?   saveCount?: IntFilter | Int,
            urlHash: {
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
            ~~~~~~~
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
              in: []
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        ?   id?: StringFilter | String,
        })
        ?   createdAt?: DateTimeFilter | DateTime,

        ?   updatedAt?: DateTimeFilter | DateTime,
Unknown argument `urlHash`. Available options are marked with ?.
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,

ðŸŒ† Scraping Los Angeles from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
ðŸ“¦ Scraped 0 total events for Los Angeles
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
            ~~~~~~~
              in: []
âŒ Error scraping Los Angeles: 
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
â†’ 176   const existing = await prisma.event.findMany({
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
          where: {
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
            urlHash: {
            ~~~~~~~
              in: []
        ?   bookingUrl?: StringNullableFilter | String | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   accessibility?: StringNullableListFilter,
        ?   id?: StringFilter | String,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping San Francisco from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for San Francisco...
ðŸ“¦ Scraped 0 total events for San Francisco
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“Š Normalized 0/0 events
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
âŒ Error scraping San Francisco: 
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
Invalid `prisma.event.findMany()` invocation in
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],

        ?   OR?: EventWhereInput[],
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
        ?   NOT?: EventWhereInput | EventWhereInput[],
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
            urlHash: {
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
            ~~~~~~~
              in: []
        ?   description?: StringNullableFilter | String | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   id?: StringFilter | String,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   city?: StringFilter | String,
        ?   saveCount24h?: IntFilter | Int,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   shareCount?: IntFilter | Int,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
          select: {
        ?   minAge?: IntNullableFilter | Int | Null,
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   tags?: StringNullableListFilter,

ðŸŒ† Scraping Chicago from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ¤ Apify: Scraping Meetup for Chicago...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“¦ Scraped 0 total events for Chicago
ðŸ“Š Normalized 0/0 events
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
prisma:error 
Invalid `prisma.event.findMany()` invocation in
âŒ Error scraping Chicago: 
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
Invalid `prisma.event.findMany()` invocation in
          where: {
            urlHash: {
            ~~~~~~~
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
        ?   NOT?: EventWhereInput | EventWhereInput[],
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   id?: StringFilter | String,
â†’ 176   const existing = await prisma.event.findMany({
          where: {
        ?   createdAt?: DateTimeFilter | DateTime,
            urlHash: {
            ~~~~~~~
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
              in: []
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   OR?: EventWhereInput[],
        ?   currency?: StringNullableFilter | String | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   saveCount?: IntFilter | Int,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   description?: StringNullableFilter | String | Null,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   venueName?: StringNullableFilter | String | Null,
          },
          select: {
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 7625ms
âœ… [2025-11-17T03:01:57.098Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}
âœ… [2025-11-17T03:01:59.524Z] Job completed: seed-events
   Result: { created: 26, minPerCity: 12 }

ðŸš€ [2025-11-17T03:02:49.523Z] Running job: ingestion-queue
âœ… [2025-11-17T03:02:49.892Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:03:49.527Z] Running job: ingestion-queue
âœ… [2025-11-17T03:03:49.929Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:04:49.537Z] Running job: ingestion-queue
âœ… [2025-11-17T03:04:49.763Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:05:49.544Z] Running job: ingestion-queue
âœ… [2025-11-17T03:05:49.831Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:06:49.596Z] Running job: ingestion-queue
âœ… [2025-11-17T03:06:49.836Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:07:49.611Z] Running job: ingestion-queue
âœ… [2025-11-17T03:07:50.753Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:08:49.658Z] Running job: ingestion-queue
âœ… [2025-11-17T03:08:49.919Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:09:49.662Z] Running job: ingestion-queue
âœ… [2025-11-17T03:09:49.929Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:10:49.685Z] Running job: ingestion-queue
âœ… [2025-11-17T03:10:49.919Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:11:49.508Z] Running job: seed-events

ðŸš€ [2025-11-17T03:11:49.697Z] Running job: ingestion-queue
âœ… [2025-11-17T03:11:51.366Z] Job completed: ingestion-queue
   Result: { processed: 0 }
âœ… [2025-11-17T03:11:52.043Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }

ðŸš€ [2025-11-17T03:12:49.704Z] Running job: ingestion-queue
âœ… [2025-11-17T03:12:49.918Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:13:49.724Z] Running job: ingestion-queue
âœ… [2025-11-17T03:13:50.991Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:14:49.732Z] Running job: ingestion-queue
âœ… [2025-11-17T03:14:50.542Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:15:49.738Z] Running job: ingestion-queue
âœ… [2025-11-17T03:15:50.064Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:16:49.531Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
âŒ [2025-11-17T03:16:49.556Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')

ðŸš€ [2025-11-17T03:16:49.748Z] Running job: ingestion-queue
âœ… [2025-11-17T03:16:49.982Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:17:49.750Z] Running job: ingestion-queue
âœ… [2025-11-17T03:17:49.995Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:18:49.766Z] Running job: ingestion-queue
âœ… [2025-11-17T03:18:50.218Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:19:49.774Z] Running job: ingestion-queue
âœ… [2025-11-17T03:19:51.171Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:20:49.776Z] Running job: ingestion-queue
âœ… [2025-11-17T03:20:50.027Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:21:49.517Z] Running job: seed-events

ðŸš€ [2025-11-17T03:21:49.789Z] Running job: ingestion-queue
âœ… [2025-11-17T03:21:51.022Z] Job completed: ingestion-queue
   Result: { processed: 0 }
âœ… [2025-11-17T03:21:52.013Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }

ðŸš€ [2025-11-17T03:22:49.795Z] Running job: ingestion-queue
âœ… [2025-11-17T03:22:50.084Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:23:49.801Z] Running job: ingestion-queue
âœ… [2025-11-17T03:23:50.103Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:24:49.811Z] Running job: ingestion-queue
âœ… [2025-11-17T03:24:50.080Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:25:49.815Z] Running job: ingestion-queue
âœ… [2025-11-17T03:25:50.079Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:26:49.820Z] Running job: ingestion-queue
âœ… [2025-11-17T03:26:50.086Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:27:49.826Z] Running job: ingestion-queue
âœ… [2025-11-17T03:27:50.983Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:28:49.826Z] Running job: ingestion-queue
âœ… [2025-11-17T03:28:50.092Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:29:49.827Z] Running job: ingestion-queue
âœ… [2025-11-17T03:29:50.027Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:30:49.830Z] Running job: ingestion-queue
âœ… [2025-11-17T03:30:50.072Z] Job completed: ingestion-queue
   Result: { processed: 0 }

âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
ðŸš€ [2025-11-17T03:31:49.530Z] Running job: seed-events

ðŸš€ [2025-11-17T03:31:49.531Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ [2025-11-17T03:31:49.534Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')

ðŸš€ [2025-11-17T03:31:49.832Z] Running job: ingestion-queue
âœ… [2025-11-17T03:31:50.968Z] Job completed: ingestion-queue
   Result: { processed: 0 }
âœ… [2025-11-17T03:31:51.497Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }

ðŸš€ [2025-11-17T03:32:49.836Z] Running job: ingestion-queue
âœ… [2025-11-17T03:32:50.042Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:33:49.849Z] Running job: ingestion-queue
âœ… [2025-11-17T03:33:51.066Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:34:49.860Z] Running job: ingestion-queue
âœ… [2025-11-17T03:34:50.108Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:35:49.865Z] Running job: ingestion-queue
âœ… [2025-11-17T03:35:50.084Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:36:49.866Z] Running job: ingestion-queue
âœ… [2025-11-17T03:36:50.087Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:37:49.937Z] Running job: ingestion-queue
prisma:error 
Invalid `prisma.ingestionRequest.findFirst()` invocation in
C:\Users\ragha\citypass\apps\worker\src\ingestionQueueJob.ts:45:49

  42 }
  43 
  44 async function claimNextRequest() {
â†’ 45   const request = await prisma.ingestionRequest.findFirst(
Timed out fetching a new connection from the connection pool. More info: http://pris.ly/d/connection-pool (Current connection pool timeout: 10, connection limit: 5)
âŒ [2025-11-17T03:38:00.312Z] Job failed: ingestion-queue
   Error: 
Invalid `prisma.ingestionRequest.findFirst()` invocation in
C:\Users\ragha\citypass\apps\worker\src\ingestionQueueJob.ts:45:49

  42 }
  43 
  44 async function claimNextRequest() {
â†’ 45   const request = await prisma.ingestionRequest.findFirst(
Timed out fetching a new connection from the connection pool. More info: http://pris.ly/d/connection-pool (Current connection pool timeout: 10, connection limit: 5)
prisma:error Error in PostgreSQL connection: Error { kind: Io, cause: Some(Os { code: 10054, kind: ConnectionReset, message: "An existing connection was forcibly closed by the remote host." }) }
prisma:error Error in PostgreSQL connection: Error { kind: Io, cause: Some(Os { code: 10054, kind: ConnectionReset, message: "An existing connection was forcibly closed by the remote host." }) }
prisma:error Error in PostgreSQL connection: Error { kind: Io, cause: Some(Os { code: 10054, kind: ConnectionReset, message: "An existing connection was forcibly closed by the remote host." }) }

ðŸš€ [2025-11-17T03:38:49.946Z] Running job: ingestion-queue
âœ… [2025-11-17T03:38:51.049Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:39:49.959Z] Running job: ingestion-queue
âœ… [2025-11-17T03:39:50.232Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:40:49.966Z] Running job: ingestion-queue
âœ… [2025-11-17T03:40:50.176Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:41:49.539Z] Running job: seed-events

ðŸš€ [2025-11-17T03:41:54.609Z] Running job: ingestion-queue
âœ… [2025-11-17T03:41:56.719Z] Job completed: ingestion-queue
   Result: { processed: 0 }
âœ… [2025-11-17T03:42:00.440Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }

ðŸš€ [2025-11-17T03:42:54.622Z] Running job: ingestion-queue
âœ… [2025-11-17T03:42:54.911Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:43:54.634Z] Running job: ingestion-queue
âœ… [2025-11-17T03:43:54.829Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:44:54.644Z] Running job: ingestion-queue
âœ… [2025-11-17T03:44:54.841Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:45:54.659Z] Running job: ingestion-queue
âœ… [2025-11-17T03:45:54.873Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:46:49.719Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
âŒ [2025-11-17T03:46:51.483Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')

ðŸš€ [2025-11-17T03:46:54.666Z] Running job: ingestion-queue
âœ… [2025-11-17T03:46:55.810Z] Job completed: ingestion-queue
   Result: { processed: 0 }
10:47:51 PM [tsx] change in ./..\..\packages\llm\src\embeddings.ts Restarting...
Typesense module not available, search indexing disabled
c10:48:03 PM [tsx] change in ./..\..\packages\llm\src\embeddings.ts Restarting...
Typesense module not available, search indexing disabled
c[dotenv@17.2.3] injecting env (52) from ..\..\.env -- tip: ðŸ—‚ï¸ backup and recover secrets: https://dotenvx.com/ops
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 52 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T03:48:19.910Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T03:48:19.917Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T03:48:19.919Z] Running job: ingestion-queue
  âœ“ Scheduled: ingestion-queue (every 60s)

ðŸš€ [2025-11-17T03:48:19.920Z] Running job: social-embed-index
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
ðŸ”„ Starting social embedding and indexing...
  âœ“ Scheduled: social-embed-index (every 900s)

ðŸš€ [2025-11-17T03:48:19.921Z] Running job: graph-similarity-refresh
ðŸ”„ Starting similarity edge refresh...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T03:48:19.940Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351300157, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T03:48:20.160Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351300157, routers=[], readers=[], writers=[]]
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for New York...
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
âœ… [2025-11-17T03:48:21.189Z] Job completed: ingestion-queue
   Result: { processed: 0 }
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
Retry 2/3 after 4000ms...
âœ… [2025-11-17T03:48:23.420Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“¦ Scraped 0 total events for New York
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
âŒ Error scraping New York: 
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
Invalid `prisma.event.findMany()` invocation in
            urlHash: {
            ~~~~~~~
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

              in: []
  173 if (skipDuplicates) {
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
  174   // Check for existing events by URL hash
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   sourceUrl?: StringFilter | String,
â†’ 176   const existing = await prisma.event.findMany({
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
          where: {
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
            urlHash: {
            ~~~~~~~
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
              in: []
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   OR?: EventWhereInput[],
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
        ?   createdAt?: DateTimeFilter | DateTime,
            urlHash: true,
            contentHash: true
          }
        })
        ?   updatedAt?: DateTimeFilter | DateTime,

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping Los Angeles from 2 sources...
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
        ?   city?: StringFilter | String,
ðŸ“¦ Scraped 0 total events for Los Angeles
ðŸ“Š Normalized 0/0 events
        ?   startTime?: DateTimeFilter | DateTime,
prisma:error 
Invalid `prisma.event.findMany()` invocation in
        ?   subtitle?: StringNullableFilter | String | Null,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
        ?   description?: StringNullableFilter | String | Null,
          where: {
            urlHash: {
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
            ~~~~~~~
              in: []
            },
        ?   organizer?: StringNullableFilter | String | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   venueName?: StringNullableFilter | String | Null,
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   minAge?: IntNullableFilter | Int | Null,
          select: {
            id: true,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping San Francisco from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
ðŸ¤ Apify: Scraping Meetup for San Francisco...
        ?   bookingUrl?: StringNullableFilter | String | Null,
ðŸ“¦ Scraped 0 total events for San Francisco
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
ðŸ“Š Normalized 0/0 events
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
â†’ 176   const existing = await prisma.event.findMany({
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
          where: {
            urlHash: {
            ~~~~~~~
              in: []
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
            },
          },
        ?   AND?: EventWhereInput | EventWhereInput[],
          select: {
            id: true,
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
            urlHash: true,
            contentHash: true
        ?   updatedAt?: DateTimeFilter | DateTime,
          }
        })
        ?   sourceUrl?: StringFilter | String,

        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
Unknown argument `urlHash`. Available options are marked with ?.
        ?   startTime?: DateTimeFilter | DateTime,
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
        ?   subtitle?: StringNullableFilter | String | Null,
âŒ Error scraping Los Angeles: 
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

        ?   organizer?: StringNullableFilter | String | Null,
  173 if (skipDuplicates) {
        ?   venueName?: StringNullableFilter | String | Null,
  174   // Check for existing events by URL hash
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   lat?: FloatNullableFilter | Float | Null,
â†’ 176   const existing = await prisma.event.findMany({
          where: {
        ?   lon?: FloatNullableFilter | Float | Null,
            urlHash: {
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
            ~~~~~~~
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
              in: []
        ?   currency?: StringNullableFilter | String | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   sourceUrl?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
          },
          select: {
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

        ?   organizer?: StringNullableFilter | String | Null,
Unknown argument `urlHash`. Available options are marked with ?.
        ?   venueName?: StringNullableFilter | String | Null,

ðŸŒ† Scraping Chicago from 2 sources...
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
ðŸ¤ Apify: Scraping Meetup for Chicago...
ðŸ“¦ Scraped 0 total events for Chicago
        ?   lat?: FloatNullableFilter | Float | Null,
ðŸ“Š Normalized 0/0 events
prisma:error 
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
Invalid `prisma.event.findMany()` invocation in
        ?   priceMin?: FloatNullableFilter | Float | Null,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   priceMax?: FloatNullableFilter | Float | Null,

        ?   currency?: StringNullableFilter | String | Null,
  173 if (skipDuplicates) {
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
  174   // Check for existing events by URL hash
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
        ?   viewCount24h?: IntFilter | Int,
          where: {
            urlHash: {
        ?   saveCount?: IntFilter | Int,
            ~~~~~~~
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   accessibility?: StringNullableListFilter,
          },
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
          select: {
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
            id: true,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
            urlHash: true,
            contentHash: true
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          }
          select: {
            id: true,
        })
            urlHash: true,
            contentHash: true

          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
âŒ Error scraping San Francisco: 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
âŒ Error scraping Chicago: 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 12621ms
âœ… [2025-11-17T03:48:32.533Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}

ðŸš€ [2025-11-17T03:49:19.946Z] Running job: ingestion-queue
âœ… [2025-11-17T03:49:20.225Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:50:19.957Z] Running job: ingestion-queue
âœ… [2025-11-17T03:50:20.151Z] Job completed: ingestion-queue
   Result: { processed: 0 }
10:50:36 PM [tsx] change in ./..\..\packages\llm\src\extraction-enhanced.ts Restarting...
Typesense module not available, search indexing disabled
c[dotenv@17.2.3] injecting env (52) from ..\..\.env -- tip: âœ… audit secrets and track compliance: https://dotenvx.com/ops
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 52 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T03:51:04.390Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T03:51:04.410Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T03:51:04.416Z] Running job: ingestion-queue
  âœ“ Scheduled: ingestion-queue (every 60s)

ðŸš€ [2025-11-17T03:51:04.423Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
  âœ“ Scheduled: social-embed-index (every 900s)

ðŸš€ [2025-11-17T03:51:04.425Z] Running job: graph-similarity-refresh
ðŸ”„ Starting similarity edge refresh...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T03:51:04.491Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351464906, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T03:51:04.908Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351464906, routers=[], readers=[], writers=[]]
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
ðŸ¤ Apify: Scraping Meetup for New York...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
âœ… [2025-11-17T03:51:06.571Z] Job completed: ingestion-queue
   Result: { processed: 0 }
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
Retry 2/3 after 4000ms...
âœ… [2025-11-17T03:51:07.340Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“¦ Scraped 0 total events for New York
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
âŒ Error scraping New York: 
Invalid `prisma.event.findMany()` invocation in
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   saveCount?: IntFilter | Int,

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
          where: {
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
            urlHash: {
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            ~~~~~~~
            contentHash: true
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
          }
        ?   OR?: EventWhereInput[],
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping Los Angeles from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for Los Angeles
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
âŒ Error scraping Los Angeles: 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  174   // Check for existing events by URL hash
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
          where: {
            urlHash: {
            ~~~~~~~
              in: []
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
            },
        ?   OR?: EventWhereInput[],
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   id?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   title?: StringFilter | String,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   city?: StringFilter | String,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   viewCount?: IntFilter | Int,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   address?: StringNullableFilter | String | Null,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
          select: {
            id: true,
        ?   timezone?: StringNullableFilter | String | Null,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping San Francisco from 2 sources...
        ?   priceMin?: FloatNullableFilter | Float | Null,
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for San Francisco...
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for San Francisco
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
âŒ Error scraping San Francisco: 
Invalid `prisma.event.findMany()` invocation in
  174   // Check for existing events by URL hash
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
            urlHash: {
            ~~~~~~~
              in: []
            },
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
â†’ 176   const existing = await prisma.event.findMany({
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
          where: {
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
            urlHash: {
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
            ~~~~~~~
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
              in: []
        ?   bookingUrl?: StringNullableFilter | String | Null,
            },
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   saveCount?: IntFilter | Int,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceDomain?: StringFilter | String,
        ?   sourceUrl?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
          select: {
            id: true,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
            urlHash: true,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
            contentHash: true
          }
        })
        ?   address?: StringNullableFilter | String | Null,

Unknown argument `urlHash`. Available options are marked with ?.
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,

        ?   priceMin?: FloatNullableFilter | Float | Null,
ðŸŒ† Scraping Chicago from 2 sources...
        ?   priceMax?: FloatNullableFilter | Float | Null,
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for Chicago...
ðŸ“¦ Scraped 0 total events for Chicago
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“Š Normalized 0/0 events
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
prisma:error 
âŒ Error scraping Chicago: 
Invalid `prisma.event.findMany()` invocation in
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41


  173 if (skipDuplicates) {
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
  174   // Check for existing events by URL hash
            },
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
â†’ 176   const existing = await prisma.event.findMany({
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
          where: {
        ?   sourceUrl?: StringFilter | String,
            urlHash: {
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
            ~~~~~~~
              in: []
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
            },
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   OR?: EventWhereInput[],
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   saveCount24h?: IntFilter | Int,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   city?: StringFilter | String,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
          select: {
            id: true,
        ?   lat?: FloatNullableFilter | Float | Null,
            urlHash: true,
            contentHash: true
          }
        })

        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
Unknown argument `urlHash`. Available options are marked with ?.
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 7255ms
âœ… [2025-11-17T03:51:11.647Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}
10:51:17 PM [tsx] change in ./..\..\packages\llm\src\extraction.ts Restarting...
Typesense module not available, search indexing disabled
c[dotenv@17.2.3] injecting env (52) from ..\..\.env -- tip: ðŸ” prevent building .env in docker: https://dotenvx.com/prebuild
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 52 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T03:51:30.335Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T03:51:30.344Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T03:51:30.345Z] Running job: ingestion-queue
  âœ“ Scheduled: ingestion-queue (every 60s)

ðŸš€ [2025-11-17T03:51:30.347Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
  âœ“ Scheduled: social-embed-index (every 900s)

ðŸš€ [2025-11-17T03:51:30.347Z] Running job: graph-similarity-refresh
ðŸ”„ Starting similarity edge refresh...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T03:51:30.365Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351490479, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T03:51:30.481Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351490479, routers=[], readers=[], writers=[]]
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for New York...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
âœ… [2025-11-17T03:51:32.182Z] Job completed: ingestion-queue
   Result: { processed: 0 }
Retry 2/3 after 4000ms...
âœ… [2025-11-17T03:51:32.861Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“¦ Scraped 0 total events for New York
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
âŒ Error scraping New York: 
        ?   venueName?: StringNullableFilter | String | Null,
Invalid `prisma.event.findMany()` invocation in
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   timezone?: StringNullableFilter | String | Null,

        ?   priceMin?: FloatNullableFilter | Float | Null,
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   priceMax?: FloatNullableFilter | Float | Null,
â†’ 176   const existing = await prisma.event.findMany({
          where: {
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
            urlHash: {
            ~~~~~~~
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
              in: []
            },
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   OR?: EventWhereInput[],
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   id?: StringFilter | String,
          },
          select: {
            id: true,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
            urlHash: true,
            contentHash: true
        ?   title?: StringFilter | String,
          }
        ?   city?: StringFilter | String,
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,

ðŸŒ† Scraping Los Angeles from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for Los Angeles
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
âŒ Error scraping Los Angeles: 
â†’ 176   const existing = await prisma.event.findMany({
Invalid `prisma.event.findMany()` invocation in
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,

        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
  173 if (skipDuplicates) {
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
  174   // Check for existing events by URL hash
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
â†’ 176   const existing = await prisma.event.findMany({
          where: {
        ?   viewCount24h?: IntFilter | Int,
            urlHash: {
            ~~~~~~~
              in: []
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
            },
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
        ?   id?: StringFilter | String,
            urlHash: true,
            contentHash: true
        ?   createdAt?: DateTimeFilter | DateTime,
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   updatedAt?: DateTimeFilter | DateTime,

        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
ðŸŒ† Scraping San Francisco from 2 sources...
        ?   city?: StringFilter | String,
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for San Francisco...
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for San Francisco
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
âŒ Error scraping San Francisco: 
  174   // Check for existing events by URL hash
Invalid `prisma.event.findMany()` invocation in
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
            urlHash: {

            ~~~~~~~
  173 if (skipDuplicates) {
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
  174   // Check for existing events by URL hash
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
â†’ 176   const existing = await prisma.event.findMany({
        ?   updatedAt?: DateTimeFilter | DateTime,
          where: {
            urlHash: {
            ~~~~~~~
              in: []
        ?   sourceUrl?: StringFilter | String,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   title?: StringFilter | String,
        ?   OR?: EventWhereInput[],
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   saveCount24h?: IntFilter | Int,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   shareCount?: IntFilter | Int,
        ?   sourceUrl?: StringFilter | String,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
        ?   description?: StringNullableFilter | String | Null,
            contentHash: true
          }
        })
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,

Unknown argument `urlHash`. Available options are marked with ?.
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,

ðŸŒ† Scraping Chicago from 2 sources...
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for Chicago...
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for Chicago
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
âŒ Error scraping Chicago: 
        ?   address?: StringNullableFilter | String | Null,
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
  174   // Check for existing events by URL hash
        ?   lon?: FloatNullableFilter | Float | Null,
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
â†’ 176   const existing = await prisma.event.findMany({
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
          where: {
        ?   tags?: StringNullableListFilter,
            urlHash: {
            ~~~~~~~
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
              in: []
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
            },
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   shareCount?: IntFilter | Int,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
          },
        ?   title?: StringFilter | String,
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 7006ms
âœ… [2025-11-17T03:51:37.342Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}

ðŸš€ [2025-11-17T03:52:30.365Z] Running job: ingestion-queue
âœ… [2025-11-17T03:52:33.189Z] Job completed: ingestion-queue
   Result: { processed: 0 }
10:53:16 PM [tsx] change in ./..\..\packages\llm\src\extraction-enhanced.ts Restarting...
Typesense module not available, search indexing disabled
c[dotenv@17.2.3] injecting env (52) from ..\..\.env -- tip: âš™ï¸  enable debug logging with { debug: true }
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 52 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T03:53:40.892Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T03:53:40.902Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T03:53:40.904Z] Running job: ingestion-queue
  âœ“ Scheduled: ingestion-queue (every 60s)

ðŸš€ [2025-11-17T03:53:40.906Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
  âœ“ Scheduled: social-embed-index (every 900s)

ðŸš€ [2025-11-17T03:53:40.907Z] Running job: graph-similarity-refresh
ðŸ”„ Starting similarity edge refresh...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T03:53:40.928Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351621131, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T03:53:41.132Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351621131, routers=[], readers=[], writers=[]]
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for New York...
âŒ Apify Meetup error: Actor with this name was not found
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
âœ… [2025-11-17T03:53:42.198Z] Job completed: ingestion-queue
   Result: { processed: 0 }
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
Retry 2/3 after 4000ms...
âœ… [2025-11-17T03:53:44.409Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“¦ Scraped 0 total events for New York
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
âŒ Error scraping New York: 
Invalid `prisma.event.findMany()` invocation in
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   description?: StringNullableFilter | String | Null,

  173 if (skipDuplicates) {
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
  174   // Check for existing events by URL hash
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
          where: {
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
            urlHash: {
            ~~~~~~~
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
              in: []
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
            },
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   AND?: EventWhereInput | EventWhereInput[],
          },
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
          select: {
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
            id: true,
        ?   updatedAt?: DateTimeFilter | DateTime,
            urlHash: true,
        ?   sourceUrl?: StringFilter | String,
            contentHash: true
          }
        })
        ?   title?: StringFilter | String,

Unknown argument `urlHash`. Available options are marked with ?.
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,

        ?   organizer?: StringNullableFilter | String | Null,
ðŸŒ† Scraping Los Angeles from 2 sources...
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for Los Angeles
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
âŒ Error scraping Los Angeles: 
Invalid `prisma.event.findMany()` invocation in
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   OR?: EventWhereInput[],

        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
  173 if (skipDuplicates) {
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
  174   // Check for existing events by URL hash
        ?   title?: StringFilter | String,
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
          where: {
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
            urlHash: {
            ~~~~~~~
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
              in: []
        ?   address?: StringNullableFilter | String | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   OR?: EventWhereInput[],
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   id?: StringFilter | String,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   clickCount?: IntFilter | Int,
        ?   title?: StringFilter | String,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
        ?   subtitle?: StringNullableFilter | String | Null,
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,

        ?   neighborhood?: StringNullableFilter | String | Null,
ðŸŒ† Scraping San Francisco from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
ðŸ¤ Apify: Scraping Meetup for San Francisco...
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for San Francisco
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
âŒ Error scraping San Francisco: 
Invalid `prisma.event.findMany()` invocation in
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,

        ?   title?: StringFilter | String,
  173 if (skipDuplicates) {
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
  174   // Check for existing events by URL hash
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
          where: {
            urlHash: {
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
            ~~~~~~~
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
              in: []
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   OR?: EventWhereInput[],
        ?   accessibility?: StringNullableListFilter,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   viewCount?: IntFilter | Int,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   viewCount24h?: IntFilter | Int,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   city?: StringFilter | String,
        ?   shareCount?: IntFilter | Int,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
        ?   venueName?: StringNullableFilter | String | Null,
          },
          select: {
            id: true,
        ?   address?: StringNullableFilter | String | Null,
            urlHash: true,
            contentHash: true
          }
        })
        ?   neighborhood?: StringNullableFilter | String | Null,

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping Chicago from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ¤ Apify: Scraping Meetup for Chicago...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“¦ Scraped 0 total events for Chicago
ðŸ“Š Normalized 0/0 events
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
âŒ Error scraping Chicago: 
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,

        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
  173 if (skipDuplicates) {
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
  174   // Check for existing events by URL hash
        ?   minAge?: IntNullableFilter | Int | Null,
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
â†’ 176   const existing = await prisma.event.findMany({
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
          where: {
            urlHash: {
        ?   saveCount24h?: IntFilter | Int,
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   sourceUrl?: StringFilter | String,
          select: {
            id: true,
            urlHash: true,
            contentHash: true
        ?   title?: StringFilter | String,
          }
        })

        ?   city?: StringFilter | String,
Unknown argument `urlHash`. Available options are marked with ?.
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 6963ms
âœ… [2025-11-17T03:53:47.856Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}

ðŸš€ [2025-11-17T03:54:40.913Z] Running job: ingestion-queue
âœ… [2025-11-17T03:54:41.199Z] Job completed: ingestion-queue
   Result: { processed: 0 }
10:54:54 PM [tsx] change in ./..\..\packages\llm\src\extraction.ts Restarting...
Typesense module not available, search indexing disabled
c[dotenv@17.2.3] injecting env (52) from ..\..\.env -- tip: ðŸ” encrypt with Dotenvx: https://dotenvx.com
[Worker] Loading .env from: C:\Users\ragha\citypass\.env
[Worker] Loaded 52 environment variables
[Worker] OPENAI_API_KEY present: true
[Worker] DATABASE_URL present: true
[Worker] DATABASE_URL: postgres://postgres:JfWnsUut6f7XSEMA@eoabuyvlsakqk...
â° Starting cron scheduler...

ðŸš€ [2025-11-17T03:55:07.910Z] Running job: scrape-events

ðŸ•·ï¸ Starting scraper cycle for 4 cities...

ðŸŒ† Scraping New York from 3 sources...
ðŸŽ« Apify: Scraping Eventbrite for New York...
  âœ“ Scheduled: scrape-events (every 3600s)

ðŸš€ [2025-11-17T03:55:07.916Z] Running job: seed-events
  âœ“ Scheduled: seed-events (every 600s)

ðŸš€ [2025-11-17T03:55:07.918Z] Running job: ingestion-queue
  âœ“ Scheduled: ingestion-queue (every 60s)

ðŸš€ [2025-11-17T03:55:07.920Z] Running job: social-embed-index
ðŸ”„ Starting social embedding and indexing...
âŒ Social embedding failed: Cannot read properties of undefined (reading 'findMany')
  âœ“ Scheduled: social-embed-index (every 900s)

ðŸš€ [2025-11-17T03:55:07.921Z] Running job: graph-similarity-refresh
ðŸ”„ Starting similarity edge refresh...
  âœ“ Scheduled: graph-similarity-refresh (every 86400s)
ðŸ‘· CityPass Worker starting...
âŒ [2025-11-17T03:55:07.935Z] Job failed: social-embed-index
   Error: Cannot read properties of undefined (reading 'findMany')
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
Failed to obtain server version. Unable to check client-server compatibility. Set checkCompatibility=false to skip version check.
âŒ Similarity refresh failed: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351708046, routers=[], readers=[], writers=[]]
âŒ [2025-11-17T03:55:08.048Z] Job failed: graph-similarity-refresh
   Error: Could not perform discovery. No routing servers available. Known routing table: RoutingTable[database=default database, expirationTime=0, currentTime=1763351708046, routers=[], readers=[], writers=[]]
ðŸ¤ Apify: Scraping Meetup for New York...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸŽ§ Scraping Resident Advisor: https://ra.co/events/us/newyork
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ”¥ Firecrawl: Scraping https://ra.co/events/us/newyork for New York...
Retry 1/3 after 2000ms...
âœ… [2025-11-17T03:55:09.884Z] Job completed: ingestion-queue
   Result: { processed: 0 }
ðŸ“‹ Found 0 active sources
âœ… Worker cycle complete
ðŸ Initial crawl finished
Retry 2/3 after 4000ms...
âœ… [2025-11-17T03:55:10.573Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }
âŒ Firecrawl error for https://ra.co/events/us/newyork: firecrawl.scrapeUrl is not a function
âš ï¸ residentadvisor had 1 errors: [ 'firecrawl.scrapeUrl is not a function' ]
ðŸ“¦ Scraped 0 total events for New York
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
âŒ Error scraping New York: 
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
        ?   title?: StringFilter | String,
  174   // Check for existing events by URL hash
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   subtitle?: StringNullableFilter | String | Null,
â†’ 176   const existing = await prisma.event.findMany({
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
          where: {
            urlHash: {
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
            ~~~~~~~
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
              in: []
            },
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   OR?: EventWhereInput[],
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   sourceDomain?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
        ?   subtitle?: StringNullableFilter | String | Null,
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,

        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
ðŸŒ† Scraping Los Angeles from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Los Angeles...
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ¤ Apify: Scraping Meetup for Los Angeles...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“¦ Scraped 0 total events for Los Angeles
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“Š Normalized 0/0 events
prisma:error 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
âŒ Error scraping Los Angeles: 
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
Invalid `prisma.event.findMany()` invocation in
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
        ?   venueName?: StringNullableFilter | String | Null,
â†’ 176   const existing = await prisma.event.findMany({
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
          where: {
            urlHash: {
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
            ~~~~~~~
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   accessibility?: StringNullableListFilter,
        ?   OR?: EventWhereInput[],
        ?   viewCount?: IntFilter | Int,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
        ?   sourceUrl?: StringFilter | String,
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping San Francisco from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for San Francisco...
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ¤ Apify: Scraping Meetup for San Francisco...
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
âŒ Apify Meetup error: Actor with this name was not found
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
ðŸ“¦ Scraped 0 total events for San Francisco
ðŸ“Š Normalized 0/0 events
prisma:error 
âŒ Error scraping San Francisco: 
Invalid `prisma.event.findMany()` invocation in
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41

  173 if (skipDuplicates) {

  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
  174   // Check for existing events by URL hash
              in: []
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
          where: {
            urlHash: {
            ~~~~~~~
              in: []
        ?   city?: StringFilter | String,
            },
        ?   startTime?: DateTimeFilter | DateTime,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   title?: StringFilter | String,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   city?: StringFilter | String,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   viewCount24h?: IntFilter | Int,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   saveCount?: IntFilter | Int,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
        ?   timezone?: StringNullableFilter | String | Null,
            urlHash: true,
            contentHash: true
          }
        })
        ?   priceMin?: FloatNullableFilter | Float | Null,

        ?   priceMax?: FloatNullableFilter | Float | Null,
Unknown argument `urlHash`. Available options are marked with ?.

ðŸŒ† Scraping Chicago from 2 sources...
ðŸŽ« Apify: Scraping Eventbrite for Chicago...
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
âŒ Apify Eventbrite error: Actor with this name was not found
âš ï¸ eventbrite had 1 errors: [ 'Actor with this name was not found' ]
ðŸ¤ Apify: Scraping Meetup for Chicago...
âŒ Apify Meetup error: Actor with this name was not found
ðŸ“¦ Scraped 0 total events for Chicago
ðŸ“Š Normalized 0/0 events
prisma:error 
âš ï¸ meetup had 1 errors: [ 'Actor with this name was not found' ]
Invalid `prisma.event.findMany()` invocation in
âŒ Error scraping Chicago: 
Invalid `prisma.event.findMany()` invocation in
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41
C:\Users\ragha\citypass\apps\worker\src\scrape\normalize.ts:176:41


  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
  173 if (skipDuplicates) {
  174   // Check for existing events by URL hash
  175   const urlHashes = normalized.map(e => e.urlHash);
â†’ 176   const existing = await prisma.event.findMany({
â†’ 176   const existing = await prisma.event.findMany({
          where: {
            urlHash: {
            ~~~~~~~
              in: []
          where: {
            },
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   id?: StringFilter | String,
            urlHash: {
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   updatedAt?: DateTimeFilter | DateTime,
            ~~~~~~~
        ?   sourceUrl?: StringFilter | String,
        ?   title?: StringFilter | String,
              in: []
        ?   city?: StringFilter | String,
            },
        ?   startTime?: DateTimeFilter | DateTime,
        ?   AND?: EventWhereInput | EventWhereInput[],
        ?   OR?: EventWhereInput[],
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   NOT?: EventWhereInput | EventWhereInput[],
        ?   description?: StringNullableFilter | String | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   venueName?: StringNullableFilter | String | Null,
        ?   address?: StringNullableFilter | String | Null,
        ?   id?: StringFilter | String,
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   createdAt?: DateTimeFilter | DateTime,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   updatedAt?: DateTimeFilter | DateTime,
        ?   sourceUrl?: StringFilter | String,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   title?: StringFilter | String,
        ?   city?: StringFilter | String,
        ?   startTime?: DateTimeFilter | DateTime,
        ?   viewCount?: IntFilter | Int,
        ?   subtitle?: StringNullableFilter | String | Null,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   description?: StringNullableFilter | String | Null,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   category?: EnumEventCategoryNullableFilter | EventCategory | Null,
        ?   organizer?: StringNullableFilter | String | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
        ?   venueName?: StringNullableFilter | String | Null,
            urlHash: true,
            contentHash: true
        ?   address?: StringNullableFilter | String | Null,
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
        ?   neighborhood?: StringNullableFilter | String | Null,
        ?   lat?: FloatNullableFilter | Float | Null,
        ?   lon?: FloatNullableFilter | Float | Null,
        ?   endTime?: DateTimeNullableFilter | DateTime | Null,
        ?   timezone?: StringNullableFilter | String | Null,
        ?   priceMin?: FloatNullableFilter | Float | Null,
        ?   priceMax?: FloatNullableFilter | Float | Null,
        ?   currency?: StringNullableFilter | String | Null,
        ?   minAge?: IntNullableFilter | Int | Null,
        ?   tags?: StringNullableListFilter,
        ?   imageUrl?: StringNullableFilter | String | Null,
        ?   bookingUrl?: StringNullableFilter | String | Null,
        ?   accessibility?: StringNullableListFilter,
        ?   viewCount?: IntFilter | Int,
        ?   viewCount24h?: IntFilter | Int,
        ?   saveCount?: IntFilter | Int,
        ?   saveCount24h?: IntFilter | Int,
        ?   shareCount?: IntFilter | Int,
        ?   clickCount?: IntFilter | Int,
        ?   sourceDomain?: StringFilter | String,
        ?   checksum?: StringFilter | String,
        ?   canonicalUrlHash?: StringFilter | String,
        ?   venueId?: StringNullableFilter | String | Null,
        ?   sourceId?: StringNullableFilter | String | Null,
        ?   venue?: VenueNullableScalarRelationFilter | VenueWhereInput | Null,
        ?   source?: SourceNullableScalarRelationFilter | SourceWhereInput | Null,
        ?   vector?: EventVectorNullableScalarRelationFilter | EventVectorWhereInput | Null
          },
          select: {
            id: true,
            urlHash: true,
            contentHash: true
          }
        })

Unknown argument `urlHash`. Available options are marked with ?.
ðŸ—‘ï¸ Deleted 0 old events
ðŸ—‘ï¸ Cleaned up 0 old events

âœ… Scraper cycle complete: 0 events in 6862ms
âœ… [2025-11-17T03:55:14.772Z] Job completed: scrape-events
   Result: {
  cities: 4,
  totalEvents: 0,
  stats: {
    'New York': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'Los Angeles': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    'San Francisco': {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    },
    Chicago: {
      totalScraped: 0,
      newEvents: 0,
      updatedEvents: 0,
      skippedEvents: 0,
      errors: 1,
      durationMs: 0
    }
  }
}

ðŸš€ [2025-11-17T03:56:07.926Z] Running job: ingestion-queue
âœ… [2025-11-17T03:56:08.201Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:57:07.946Z] Running job: ingestion-queue
âœ… [2025-11-17T03:57:08.136Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:58:07.949Z] Running job: ingestion-queue
âœ… [2025-11-17T03:58:08.134Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T03:59:07.957Z] Running job: ingestion-queue
âœ… [2025-11-17T03:59:08.145Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T04:00:07.965Z] Running job: ingestion-queue
âœ… [2025-11-17T04:00:08.151Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T04:01:07.978Z] Running job: ingestion-queue
âœ… [2025-11-17T04:01:08.983Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T04:02:07.981Z] Running job: ingestion-queue
âœ… [2025-11-17T04:02:08.167Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T04:03:07.991Z] Running job: ingestion-queue
âœ… [2025-11-17T04:03:08.196Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T04:04:07.994Z] Running job: ingestion-queue
âœ… [2025-11-17T04:04:08.174Z] Job completed: ingestion-queue
   Result: { processed: 0 }

ðŸš€ [2025-11-17T04:05:07.923Z] Running job: seed-events

ðŸš€ [2025-11-17T04:05:08.004Z] Running job: ingestion-queue
âœ… [2025-11-17T04:05:09.621Z] Job completed: seed-events
   Result: { created: 0, minPerCity: 12 }

ðŸš€ [2025-11-17T04:06:08.022Z] Running job: ingestion-queue
âœ… [2025-11-17T04:06:08.286Z] Job completed: ingestion-queue
   Result: { processed: 0 }
