
> @citypass/web@1.0.0 dev C:\Users\ragha\citypass\apps\web
> next dev

   â–² Next.js 16.0.1 (Turbopack)
   - Local:        http://localhost:3000
   - Network:      http://172.27.208.1:3000

 âœ“ Starting...
 â—‹ Compiling middleware ...
 âš  The "middleware" file convention is deprecated. Please use "proxy" instead. Learn more: https://nextjs.org/docs/messages/middleware-to-proxy
 âœ“ Ready in 10.1s
 â—‹ Compiling /search ...
 GET /search?category=FITNESS&city=New+York&timePreference=afternoon 200 in 18.3s (compile: 17.2s, proxy.ts: 255ms, render: 788ms)
 â—‹ Compiling / ...
 GET / 200 in 5.6s (compile: 4.5s, proxy.ts: 14ms, render: 1098ms)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT "public"."user_consents"."id", "public"."user_consents"."analytics", "public"."user_consents"."personalization", "public"."user_consents"."advertising", "public"."user_consents"."created_at" FROM "public"."user_consents" WHERE ("public"."user_consents"."session_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
 GET /api/consent?sessionId=test123 200 in 10.0s (compile: 8.8s, render: 1184ms)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "fitness workout gym" in New York [FITNESS]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "food dining restaurants" in New York [FOOD]
ğŸ“Š Tier 1: Enhanced database search
(node:4756) [DEP0169] DeprecationWarning: `url.parse()` behavior is not standardized and prone to errors that have security implications. Use the WHATWG URL API instead. CVEs are not issued for `url.parse()` vulnerabilities.
(Use `node --trace-deprecation ...` to show where the warning was created)
ğŸ“Š Tier 1: Enhanced database search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "dancing clubs music" in New York [MUSIC]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "theatre shows performances" in New York
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "music" in New York
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "yoga meditation wellness" in New York [FITNESS]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "bars nightlife" in New York [MUSIC]
ğŸ“Š Tier 1: Enhanced database search
ğŸ“Š Tier 1: Enhanced database search
ğŸ“Š Tier 1: Enhanced database search
ğŸ“Š Tier 1: Enhanced database search
ğŸ“Š Tier 1: Enhanced database search
Request #1762711449184: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
Request #1762711449184: Sleeping for 0.1s and then retrying request...
Request #1762711449349: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
Request #1762711449349: Sleeping for 0.1s and then retrying request...
Request #1762711449633: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
Request #1762711449633: Sleeping for 0.1s and then retrying request...
Request #1762711449652: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
Request #1762711449652: Sleeping for 0.1s and then retrying request...
Request #1762711449657: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
Request #1762711449657: Sleeping for 0.1s and then retrying request...
Request #1762711449662: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
Request #1762711449662: Sleeping for 0.1s and then retrying request...
Request #1762711449666: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
Request #1762711449666: Sleeping for 0.1s and then retrying request...
Request #1762711449184: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
   âš ï¸ Typesense search failed, continuing with Prisma only: timeout of 2000ms exceeded
Request #1762711449349: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
   âš ï¸ Typesense search failed, continuing with Prisma only: timeout of 2000ms exceeded
Request #1762711449633: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
   âš ï¸ Typesense search failed, continuing with Prisma only: timeout of 2000ms exceeded
Request #1762711449652: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
   âš ï¸ Typesense search failed, continuing with Prisma only: timeout of 2000ms exceeded
Request #1762711449657: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
   âš ï¸ Typesense search failed, continuing with Prisma only: timeout of 2000ms exceeded
Request #1762711449662: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
   âš ï¸ Typesense search failed, continuing with Prisma only: timeout of 2000ms exceeded
Request #1762711449666: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
   âš ï¸ Typesense search failed, continuing with Prisma only: timeout of 2000ms exceeded
Client version 1.15.1 is incompatible with server version 1.7.4. Major versions should match and minor version difference must not exceed 1. Set checkCompatibility=false to skip version check.
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT 1
prisma:query SELECT "public"."user_consents"."id", "public"."user_consents"."analytics", "public"."user_consents"."personalization", "public"."user_consents"."advertising", "public"."user_consents"."created_at" FROM "public"."user_consents" WHERE ("public"."user_consents"."session_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
 GET /api/consent?sessionId=test123 200 in 847ms (compile: 365ms, render: 482ms)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "music" in New York
ğŸ“Š Tier 1: Enhanced database search
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
ğŸ”„ Tier 2: Adjacent event discovery
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸŒ Tier 3: Real-time web search
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: MUSIC, THEATRE, DANCE, ARTS
prisma:query SELECT 1
 â—‹ Compiling /api/search/realtime ...
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
 POST /api/search/realtime 500 in 16.0s (compile: 12.2s, render: 3.7s)
Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm347cJGnfFmT125rFr"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
ğŸ”Œ Tier 4: External APIs
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:06:30 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf3e8dabe0421b-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm347cJGnfFmT125rFr',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '33',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm347cJGnfFmT125rFr',
  error: [Object]
}
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm347cJGnfFmT125rFr"}
   ğŸ”Œ Searching external APIs for "music" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
âš ï¸ VIATOR_API_KEY not configured
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… ClassPass/Mindbody: 0 classes
   âš ï¸ Semantic search failed, continuing with keyword only
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT 1
ğŸ”„ Tier 2: Adjacent event discovery
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm3K7FtbbVUM2FZwVhB"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:06:33 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf3ea39bf6421b-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm3K7FtbbVUM2FZwVhB',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '15',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm3K7FtbbVUM2FZwVhB',
  error: [Object]
}
 POST /api/search/realtime 500 in 566ms (compile: 20ms, render: 546ms)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
âœ… Tier 2 sufficient: 13 results
 GET /api/search?q=bars%20nightlife&city=New%20York&limit=1&category=NIGHTLIFE&timePreference=afternoon 200 in 3.4min (compile: 58s, render: 2.4min)
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm3K7FtbbVUM2FZwVhB"}
ğŸ”Œ Tier 4: External APIs
   ğŸ”Œ Searching external APIs for "theatre shows performances" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "art galleries exhibitions" in New York
 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ“Š Tier 1: Enhanced database search
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 1 results across all tiers
 GET /api/search?q=theatre%20shows%20performances&city=New%20York&limit=1&category=PERFORMING_ARTS&timePreference=afternoon 200 in 3.4min (compile: 57s, render: 2.4min)
âœ… Final: 11 results across all tiers
 GET /api/search?q=music&city=New%20York 200 in 3.1min (compile: 42s, render: 2.4min)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "networking social meetups" in New York [NETWORKING]
ğŸ“Š Tier 1: Enhanced database search
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: MUSIC, THEATRE, DANCE, ARTS
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
âœ… Tier 2 sufficient: 13 results
 GET /api/search?q=dancing%20clubs%20music&city=New%20York&limit=1&category=MUSIC&timePreference=afternoon 200 in 3.4min (compile: 57s, render: 2.5min)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query SELECT "public"."user_consents"."id", "public"."user_consents"."analytics", "public"."user_consents"."personalization", "public"."user_consents"."advertising", "public"."user_consents"."created_at" FROM "public"."user_consents" WHERE ("public"."user_consents"."session_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
 GET /api/consent?sessionId=sess_1762711391959_d2u8xzcjr 200 in 129ms (compile: 21ms, render: 109ms)
 GET /search?category=NETWORKING&city=New+York&timePreference=afternoon 200 in 543ms (compile: 154ms, proxy.ts: 88ms, render: 300ms)
 GET /search?category=FITNESS&city=New+York&timePreference=afternoon 200 in 267ms (compile: 51ms, proxy.ts: 33ms, render: 183ms)
 GET /search?category=FITNESS&city=New+York&timePreference=afternoon 200 in 226ms (compile: 27ms, proxy.ts: 14ms, render: 184ms)
 GET /search?category=FITNESS&city=New+York&timePreference=afternoon 200 in 291ms (compile: 36ms, proxy.ts: 60ms, render: 195ms)
 GET /search?category=FITNESS&city=New+York&timePreference=afternoon 200 in 658ms (compile: 201ms, proxy.ts: 125ms, render: 332ms)
ğŸ”„ Tier 2: Adjacent event discovery
   âš ï¸ Semantic search failed, continuing with keyword only
   ğŸ“ Expanding to related categories: FITNESS, DANCE, OTHER, MUSIC
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
   ğŸ” Query expansion for "yoga": yoga, fitness, wellness, meditation, stretching
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
ğŸ” Search query: "" in New York [FITNESS]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT "public"."search_cache"."id", "public"."search_cache"."created_at", "public"."search_cache"."updated_at", "public"."search_cache"."city", "public"."search_cache"."query", "public"."search_cache"."category"::text, "public"."search_cache"."timeframe"::text, "public"."search_cache"."results", "public"."search_cache"."eventIds", "public"."search_cache"."generated_at", "public"."search_cache"."expires_at", "public"."search_cache"."source" FROM "public"."search_cache" WHERE ("public"."search_cache"."city" = $1 AND "public"."search_cache"."query" = $2 AND "public"."search_cache"."timeframe" = CAST($3::text AS "public"."SearchTimeframe") AND "public"."search_cache"."category" = CAST($4::text AS "public"."EventCategory") AND "public"."search_cache"."expires_at" >= $5) ORDER BY "public"."search_cache"."generated_at" DESC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."search_cache"."id", "public"."search_cache"."created_at", "public"."search_cache"."updated_at", "public"."search_cache"."city", "public"."search_cache"."query", "public"."search_cache"."category"::text, "public"."search_cache"."timeframe"::text, "public"."search_cache"."results", "public"."search_cache"."eventIds", "public"."search_cache"."generated_at", "public"."search_cache"."expires_at", "public"."search_cache"."source" FROM "public"."search_cache" WHERE ("public"."search_cache"."city" = $1 AND "public"."search_cache"."query" = $2 AND "public"."search_cache"."timeframe" = CAST($3::text AS "public"."SearchTimeframe") AND "public"."search_cache"."category" IS NULL AND "public"."search_cache"."expires_at" >= $4) ORDER BY "public"."search_cache"."generated_at" DESC LIMIT $5 OFFSET $6
 GET /api/search?city=New+York&category=FITNESS&timePreference=afternoon&cacheOnly=true 200 in 806ms (compile: 18ms, render: 788ms)
Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm3owraFUqv21r3cXiP"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:06:40 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf3ecd7eb9fbf2-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm3owraFUqv21r3cXiP',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '131',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm3owraFUqv21r3cXiP',
  error: [Object]
}
 POST /api/search/realtime 500 in 971ms (compile: 64ms, render: 907ms)
ğŸ”Œ Tier 4: External APIs
   ğŸ”Œ Searching external APIs for "yoga meditation wellness" in New York
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm3owraFUqv21r3cXiP"}
âš ï¸ EVENTBRITE_API_KEY not configured
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "" in New York [FITNESS]
ğŸ“Š Tier 1: Enhanced database search
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 4 results across all tiers
 GET /api/search?q=yoga%20meditation%20wellness&city=New%20York&limit=1&category=WELLNESS&timePreference=afternoon 200 in 3.5min (compile: 57s, render: 2.5min)
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: FOOD, FAMILY, NETWORKING, OTHER
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
   ğŸ” Query expansion for "food": food, dining, restaurant, culinary, tasting
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: FITNESS, DANCE, OTHER, MUSIC
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm3tc9RsgiZPHcRw2H5"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:06:41 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf3ed49db2fbf2-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm3tc9RsgiZPHcRw2H5',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '13',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm3tc9RsgiZPHcRw2H5',
  error: [Object]
}
 POST /api/search/realtime 500 in 1011ms (compile: 10ms, render: 1001ms)
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm3tc9RsgiZPHcRw2H5"}
ğŸ”Œ Tier 4: External APIs
   ğŸ”Œ Searching external APIs for "" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
   âœ… Eventbrite: 0 events
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 14 results across all tiers
 GET /api/search?city=New+York&category=FITNESS&limit=20&timePreference=afternoon 200 in 1582ms (compile: 98ms, render: 1484ms)
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: FITNESS, DANCE, OTHER, MUSIC
   âš ï¸ Semantic search failed, continuing with keyword only
 POST /api/search/realtime 500 in 1979ms (compile: 11ms, render: 1967ms)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm3yaHzQCULKjbkU8Wz"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:06:42 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf3edbbe136a4f-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm3yaHzQCULKjbkU8Wz',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '38',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm3yaHzQCULKjbkU8Wz',
  error: [Object]
}
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm3yaHzQCULKjbkU8Wz"}
âœ… Tier 3 sufficient: 6 results
 GET /api/search?q=food%20dining%20restaurants&city=New%20York&limit=1&category=FOOD_DRINK&timePreference=afternoon 200 in 3.5min (compile: 57s, render: 2.6min)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ” Query expansion for "art": art, gallery, museum, exhibition, artist
   âš ï¸ Semantic search failed, continuing with keyword only
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm45aCatHu7PBnXfYrZ"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:06:43 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf3ee49f8efbf2-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm45aCatHu7PBnXfYrZ',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '14',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm45aCatHu7PBnXfYrZ',
  error: [Object]
}
 POST /api/search/realtime 500 in 418ms (compile: 43ms, render: 375ms)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm45aCatHu7PBnXfYrZ"}
ğŸ”Œ Tier 4: External APIs
   ğŸ”Œ Searching external APIs for "fitness workout gym" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
ğŸŒ Tier 3: Real-time web search
âœ… Final: 4 results across all tiers
 GET /api/search?q=fitness%20workout%20gym&city=New%20York&limit=1&category=FITNESS&timePreference=afternoon 200 in 3.5min (compile: 57s, render: 2.6min)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: NETWORKING, FOOD, OTHER, ARTS
Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm47UJSQbMbumZhjcbX"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:06:44 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf3ee75d3ffbf2-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm47UJSQbMbumZhjcbX',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '15',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm47UJSQbMbumZhjcbX',
  error: [Object]
}
 POST /api/search/realtime 500 in 345ms (compile: 9ms, render: 336ms)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm47UJSQbMbumZhjcbX"}
âœ… Tier 3 sufficient: 6 results
 GET /api/search?q=art%20galleries%20exhibitions&city=New%20York&limit=1&category=VISUAL_ARTS&timePreference=afternoon 200 in 10.6s (compile: 33ms, render: 10.5s)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm499WEjYvJ7iS7Yt6L"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:06:44 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf3ee9cac4fbf2-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm499WEjYvJ7iS7Yt6L',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '34',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm499WEjYvJ7iS7Yt6L',
  error: [Object]
}
 POST /api/search/realtime 500 in 405ms (compile: 15ms, render: 390ms)
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm499WEjYvJ7iS7Yt6L"}
ğŸ”Œ Tier 4: External APIs
   ğŸ”Œ Searching external APIs for "networking social meetups" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 4 results across all tiers
 GET /api/search?q=networking%20social%20meetups&city=New%20York&limit=1&category=NETWORKING&timePreference=afternoon 200 in 9.8s (compile: 20ms, render: 9.8s)
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm7f5AYzoyE3k9tPHw1"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:07:32 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf4013eb33cc62-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxm7f5AYzoyE3k9tPHw1',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '16',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxm7f5AYzoyE3k9tPHw1',
  error: [Object]
}
 POST /api/search/realtime 500 in 336ms (compile: 17ms, render: 320ms)
ğŸ”Œ Tier 4: External APIs
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxm7f5AYzoyE3k9tPHw1"}
   ğŸ”Œ Searching external APIs for "music" in New York
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
âš ï¸ EVENTBRITE_API_KEY not configured
ğŸ’¡ Tier 5: Intelligent recommendations
âš ï¸ VIATOR_API_KEY not configured
   ğŸ’¡ Showing personalized recommendations instead
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
prisma:query SELECT 1
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 11 results across all tiers
 GET /api/search?q=music&city=New%20York 200 in 112s (compile: 37ms, render: 112s)
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT 1
prisma:query INSERT INTO "public"."user_consents" ("id","user_id","session_id","analytics","personalization","advertising","created_at","updated_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8) ON CONFLICT ("session_id") DO UPDATE SET "user_id" = $9, "analytics" = $10, "personalization" = $11, "advertising" = $12, "updated_at" = $13 WHERE ("public"."user_consents"."session_id" = $14 AND 1=1) RETURNING "public"."user_consents"."id", "public"."user_consents"."user_id", "public"."user_consents"."session_id", "public"."user_consents"."analytics", "public"."user_consents"."personalization", "public"."user_consents"."advertising", "public"."user_consents"."ip_address", "public"."user_consents"."user_agent", "public"."user_consents"."created_at", "public"."user_consents"."updated_at"
 POST /api/consent 200 in 86ms (compile: 27ms, render: 58ms)
 GET /search?city=New+York&category=MUSIC 200 in 644ms (compile: 155ms, proxy.ts: 88ms, render: 401ms)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "" in New York [MUSIC]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "" in New York [MUSIC]
ğŸ“Š Tier 1: Enhanced database search
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: MUSIC, THEATRE, DANCE, ARTS
prisma:query SELECT "public"."search_cache"."id", "public"."search_cache"."created_at", "public"."search_cache"."updated_at", "public"."search_cache"."city", "public"."search_cache"."query", "public"."search_cache"."category"::text, "public"."search_cache"."timeframe"::text, "public"."search_cache"."results", "public"."search_cache"."eventIds", "public"."search_cache"."generated_at", "public"."search_cache"."expires_at", "public"."search_cache"."source" FROM "public"."search_cache" WHERE ("public"."search_cache"."city" = $1 AND "public"."search_cache"."query" = $2 AND "public"."search_cache"."timeframe" = CAST($3::text AS "public"."SearchTimeframe") AND "public"."search_cache"."category" = CAST($4::text AS "public"."EventCategory") AND "public"."search_cache"."expires_at" >= $5) ORDER BY "public"."search_cache"."generated_at" DESC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."search_cache"."id", "public"."search_cache"."created_at", "public"."search_cache"."updated_at", "public"."search_cache"."city", "public"."search_cache"."query", "public"."search_cache"."category"::text, "public"."search_cache"."timeframe"::text, "public"."search_cache"."results", "public"."search_cache"."eventIds", "public"."search_cache"."generated_at", "public"."search_cache"."expires_at", "public"."search_cache"."source" FROM "public"."search_cache" WHERE ("public"."search_cache"."city" = $1 AND "public"."search_cache"."query" = $2 AND "public"."search_cache"."timeframe" = CAST($3::text AS "public"."SearchTimeframe") AND "public"."search_cache"."category" IS NULL AND "public"."search_cache"."expires_at" >= $4) ORDER BY "public"."search_cache"."generated_at" DESC LIMIT $5 OFFSET $6
 GET /api/search?city=New+York&category=MUSIC&cacheOnly=true 200 in 264ms (compile: 71ms, render: 192ms)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
âœ… Tier 2 sufficient: 13 results
 GET /api/search?city=New+York&category=MUSIC&limit=20 200 in 316ms (compile: 29ms, render: 287ms)
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "wine" in New York
ğŸ“Š Tier 1: Enhanced database search
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
Client version 1.15.1 is incompatible with server version 1.7.4. Major versions should match and minor version difference must not exceed 1. Set checkCompatibility=false to skip version check.
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxo7oE3B8gtEQHnuhw8j"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:33:48 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf668b1ea6f152-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxo7oE3B8gtEQHnuhw8j',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '24',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxo7oE3B8gtEQHnuhw8j',
  error: [Object]
}
 POST /api/search/realtime 500 in 393ms (compile: 12ms, render: 381ms)
ğŸ”Œ Tier 4: External APIs
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxo7oE3B8gtEQHnuhw8j"}
   ğŸ”Œ Searching external APIs for "wine" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 5 results across all tiers
 GET /api/search?q=wine&city=New%20York&limit=5 200 in 108s (compile: 2.2s, render: 106s)
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
 GET / 200 in 630ms (compile: 330ms, proxy.ts: 36ms, render: 264ms)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT "public"."user_consents"."id", "public"."user_consents"."analytics", "public"."user_consents"."personalization", "public"."user_consents"."advertising", "public"."user_consents"."created_at" FROM "public"."user_consents" WHERE ("public"."user_consents"."session_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
 GET /api/consent?sessionId=sess_1762713622695_bt7oy11ne 200 in 435ms (compile: 289ms, render: 147ms)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "food dining restaurants" in New York [FOOD]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "dancing clubs music" in New York [MUSIC]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "theatre shows performances" in New York
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "yoga meditation wellness" in New York [FITNESS]
ğŸ“Š Tier 1: Enhanced database search
ğŸ“Š Tier 1: Enhanced database search
ğŸ“Š Tier 1: Enhanced database search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "bars nightlife" in New York [MUSIC]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "fitness workout gym" in New York [FITNESS]
ğŸ“Š Tier 1: Enhanced database search
ğŸ“Š Tier 1: Enhanced database search
ğŸ“Š Tier 1: Enhanced database search
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: MUSIC, THEATRE, DANCE, ARTS
prisma:query SELECT 1
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
âœ… Tier 2 sufficient: 13 results
 GET /api/search?q=dancing%20clubs%20music&city=New%20York&limit=1&category=MUSIC&timePreference=afternoon 200 in 99s (compile: 840ms, render: 99s)
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
 GET /api/search?q=fitness%20workout%20gym&city=New%20York&limit=1&category=FITNESS&timePreference=afternoon 200 in 103s (compile: 973ms, render: 102s)
 GET /api/search?q=yoga%20meditation%20wellness&city=New%20York&limit=1&category=WELLNESS&timePreference=afternoon 200 in 103s (compile: 880ms, render: 102s)
 GET /api/search?q=food%20dining%20restaurants&city=New%20York&limit=1&category=FOOD_DRINK&timePreference=afternoon 200 in 102s (compile: 320ms, render: 102s)
 GET /api/search?q=theatre%20shows%20performances&city=New%20York&limit=1&category=PERFORMING_ARTS&timePreference=afternoon 200 in 103s (compile: 847ms, render: 102s)
 GET /api/search?q=bars%20nightlife&city=New%20York&limit=1&category=NIGHTLIFE&timePreference=afternoon 200 in 103s (compile: 957ms, render: 102s)
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: MUSIC, THEATRE, DANCE, ARTS
 GET /search?city=New+York&category=MUSIC 200 in 3.3s (compile: 1082ms, proxy.ts: 35ms, render: 2.2s)
Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxokTA56mDPwy6B2Y7qb"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:42:05 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf72aeece837a9-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxokTA56mDPwy6B2Y7qb',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '20',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxokTA56mDPwy6B2Y7qb',
  error: [Object]
}
 POST /api/search/realtime 500 in 3.7s (compile: 2.9s, render: 808ms)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxokTA56mDPwy6B2Y7qb"}
ğŸ”Œ Tier 4: External APIs
   ğŸ”Œ Searching external APIs for "theatre shows performances" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: FITNESS, DANCE, OTHER, MUSIC
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: FOOD, FAMILY, NETWORKING, OTHER
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 1 results across all tiers
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
âœ… Tier 2 sufficient: 13 results
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
ğŸŒ Tier 3: Real-time web search
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
   ğŸ” Query expansion for "food": food, dining, restaurant, culinary, tasting
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxokX1114Y1hgBHYc8wK"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:42:06 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf72b4681437a9-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxokX1114Y1hgBHYc8wK',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '17',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxokX1114Y1hgBHYc8wK',
  error: [Object]
}
 POST /api/search/realtime 500 in 260ms (compile: 8ms, render: 252ms)
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxokX1114Y1hgBHYc8wK"}
ğŸ”Œ Tier 4: External APIs
   ğŸ”Œ Searching external APIs for "fitness workout gym" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 4 results across all tiers
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxokYP6gADjEtERayqhJ"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:42:06 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf72b68c0137a9-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxokYP6gADjEtERayqhJ',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '124',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxokYP6gADjEtERayqhJ',
  error: [Object]
}
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxokYP6gADjEtERayqhJ"}
 POST /api/search/realtime 500 in 428ms (compile: 9ms, render: 419ms)
âœ… Tier 3 sufficient: 6 results
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "" in New York [MUSIC]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "" in New York [MUSIC]
ğŸ“Š Tier 1: Enhanced database search
Request #1762713732693: Request to Node 0 failed due to "ECONNABORTED timeout of 2000ms exceeded"
Request #1762713732693: Sleeping for 0.1s and then retrying request...
prisma:query SELECT "public"."user_consents"."id", "public"."user_consents"."analytics", "public"."user_consents"."personalization", "public"."user_consents"."advertising", "public"."user_consents"."created_at" FROM "public"."user_consents" WHERE ("public"."user_consents"."session_id" = $1 AND 1=1) LIMIT $2 OFFSET $3
 GET /api/consent?sessionId=sess_1762713622695_bt7oy11ne 200 in 3.8s (compile: 577ms, render: 3.2s)
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: MUSIC, THEATRE, DANCE, ARTS
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
âœ… Tier 2 sufficient: 13 results
 GET /api/search?city=New+York&category=MUSIC&limit=20 200 in 6.2s (compile: 525ms, render: 5.6s)
prisma:query SELECT "public"."search_cache"."id", "public"."search_cache"."created_at", "public"."search_cache"."updated_at", "public"."search_cache"."city", "public"."search_cache"."query", "public"."search_cache"."category"::text, "public"."search_cache"."timeframe"::text, "public"."search_cache"."results", "public"."search_cache"."eventIds", "public"."search_cache"."generated_at", "public"."search_cache"."expires_at", "public"."search_cache"."source" FROM "public"."search_cache" WHERE ("public"."search_cache"."city" = $1 AND "public"."search_cache"."query" = $2 AND "public"."search_cache"."timeframe" = CAST($3::text AS "public"."SearchTimeframe") AND "public"."search_cache"."category" = CAST($4::text AS "public"."EventCategory") AND "public"."search_cache"."expires_at" >= $5) ORDER BY "public"."search_cache"."generated_at" DESC LIMIT $6 OFFSET $7
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
prisma:query SELECT "public"."search_cache"."id", "public"."search_cache"."created_at", "public"."search_cache"."updated_at", "public"."search_cache"."city", "public"."search_cache"."query", "public"."search_cache"."category"::text, "public"."search_cache"."timeframe"::text, "public"."search_cache"."results", "public"."search_cache"."eventIds", "public"."search_cache"."generated_at", "public"."search_cache"."expires_at", "public"."search_cache"."source" FROM "public"."search_cache" WHERE ("public"."search_cache"."city" = $1 AND "public"."search_cache"."query" = $2 AND "public"."search_cache"."timeframe" = CAST($3::text AS "public"."SearchTimeframe") AND "public"."search_cache"."category" IS NULL AND "public"."search_cache"."expires_at" >= $4) ORDER BY "public"."search_cache"."generated_at" DESC LIMIT $5 OFFSET $6
 GET /api/search?city=New+York&category=MUSIC&cacheOnly=true 200 in 6.6s (compile: 526ms, render: 6.0s)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


prisma:query SELECT 1
prisma:query INSERT INTO "public"."user_consents" ("id","user_id","session_id","analytics","personalization","advertising","created_at","updated_at") VALUES ($1,$2,$3,$4,$5,$6,$7,$8) ON CONFLICT ("session_id") DO UPDATE SET "user_id" = $9, "analytics" = $10, "personalization" = $11, "advertising" = $12, "updated_at" = $13 WHERE ("public"."user_consents"."session_id" = $14 AND 1=1) RETURNING "public"."user_consents"."id", "public"."user_consents"."user_id", "public"."user_consents"."session_id", "public"."user_consents"."analytics", "public"."user_consents"."personalization", "public"."user_consents"."advertising", "public"."user_consents"."ip_address", "public"."user_consents"."user_agent", "public"."user_consents"."created_at", "public"."user_consents"."updated_at"
 POST /api/consent 200 in 93ms (compile: 10ms, render: 83ms)
   âš ï¸ Semantic search failed, continuing with keyword only
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: FITNESS, DANCE, OTHER, MUSIC
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
   ğŸ” Query expansion for "yoga": yoga, fitness, wellness, meditation, stretching
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND ("public"."events"."title" ILIKE $2 OR "public"."events"."description" ILIKE $3 OR "public"."events"."tags" @> $4) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxongAUKJgF55fDJg6zF"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:42:35 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf736b7a36f5fa-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxongAUKJgF55fDJg6zF',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '12',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxongAUKJgF55fDJg6zF',
  error: [Object]
}
 POST /api/search/realtime 500 in 476ms (compile: 14ms, render: 462ms)
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxongAUKJgF55fDJg6zF"}
ğŸ”Œ Tier 4: External APIs
   ğŸ”Œ Searching external APIs for "yoga meditation wellness" in New York
âš ï¸ EVENTBRITE_API_KEY not configured
   âœ… Eventbrite: 0 events
âš ï¸ VIATOR_API_KEY not configured
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 4 results across all tiers
prisma:query INSERT INTO "public"."search_sessions" ("id","user_id","query","city","filters","results_count","created_at") VALUES ($1,$2,$3,$4,$5,$6,$7) RETURNING "public"."search_sessions"."id", "public"."search_sessions"."user_id", "public"."search_sessions"."query", "public"."search_sessions"."city", "public"."search_sessions"."filters", "public"."search_sessions"."results_count", "public"."search_sessions"."created_at"
 GET /search?city=New+York&category=FITNESS 200 in 87ms (compile: 14ms, proxy.ts: 15ms, render: 58ms)
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "" in New York [FITNESS]
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


ğŸ” Search query: "" in New York [FITNESS]
prisma:query SELECT 1
prisma:query SELECT "public"."search_cache"."id", "public"."search_cache"."created_at", "public"."search_cache"."updated_at", "public"."search_cache"."city", "public"."search_cache"."query", "public"."search_cache"."category"::text, "public"."search_cache"."timeframe"::text, "public"."search_cache"."results", "public"."search_cache"."eventIds", "public"."search_cache"."generated_at", "public"."search_cache"."expires_at", "public"."search_cache"."source" FROM "public"."search_cache" WHERE ("public"."search_cache"."city" = $1 AND "public"."search_cache"."query" = $2 AND "public"."search_cache"."timeframe" = CAST($3::text AS "public"."SearchTimeframe") AND "public"."search_cache"."category" = CAST($4::text AS "public"."EventCategory") AND "public"."search_cache"."expires_at" >= $5) ORDER BY "public"."search_cache"."generated_at" DESC LIMIT $6 OFFSET $7
ğŸ“Š Tier 1: Enhanced database search
prisma:query SELECT "public"."search_cache"."id", "public"."search_cache"."created_at", "public"."search_cache"."updated_at", "public"."search_cache"."city", "public"."search_cache"."query", "public"."search_cache"."category"::text, "public"."search_cache"."timeframe"::text, "public"."search_cache"."results", "public"."search_cache"."eventIds", "public"."search_cache"."generated_at", "public"."search_cache"."expires_at", "public"."search_cache"."source" FROM "public"."search_cache" WHERE ("public"."search_cache"."city" = $1 AND "public"."search_cache"."query" = $2 AND "public"."search_cache"."timeframe" = CAST($3::text AS "public"."SearchTimeframe") AND "public"."search_cache"."category" IS NULL AND "public"."search_cache"."expires_at" >= $4) ORDER BY "public"."search_cache"."generated_at" DESC LIMIT $5 OFFSET $6
 GET /api/search?city=New+York&category=FITNESS&cacheOnly=true 200 in 67ms (compile: 15ms, render: 52ms)
   âš ï¸ Typesense search failed, continuing with Prisma only: Request failed with HTTP code 401 | Server said: Forbidden - a valid `x-typesense-api-key` header must be sent.
ğŸ”„ Tier 2: Adjacent event discovery
   ğŸ“ Expanding to related categories: FITNESS, DANCE, OTHER, MUSIC
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" = CAST($2::text AS "public"."EventCategory") AND "public"."events"."start_time" >= $3) ORDER BY "public"."events"."start_time" ASC LIMIT $4 OFFSET $5
ğŸŒ Tier 3: Real-time web search
 âš  ./node_modules/.pnpm/@prisma+client@6.19.0_prisma@6.19.0_typescript@5.9.3/node_modules/.prisma/client
Package @prisma/client can't be external
The request @prisma/client/runtime/library.js matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


 âš  ./packages/db/src
Package @prisma/client can't be external
The request @prisma/client matches serverExternalPackages (or the default list).
The request could not be resolved by Node.js from the project directory.
Packages that should be external need to be installed in the project directory, so they can be resolved from the output files.
Try to install it into the project directory by running npm install @prisma/client from the project directory.


Real-time search error: Error: 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxoxYnFBmUqyGcn4zRwY"}
    at async POST (src\app\api\search\realtime\route.ts:44:22)
  42 | Return only valid, real events with complete information. Maximum 5 events.`;
  43 |
> 44 |     const response = await anthropic.messages.create({
     |                      ^
  45 |       model: 'claude-3-5-sonnet-20241022',
  46 |       max_tokens: 4000,
  47 |       messages: [{ role: 'user', content: searchPrompt }], {
  status: 401,
  headers: Headers {
    date: 'Sun, 09 Nov 2025 18:44:49 GMT',
    'content-type': 'application/json',
    'content-length': '130',
    connection: 'keep-alive',
    'cf-ray': '99bf76b08ed8de6d-EWR',
    'x-should-retry': 'false',
    'request-id': 'req_011CUxoxYnFBmUqyGcn4zRwY',
    'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
    'x-envoy-upstream-service-time': '13',
    'cf-cache-status': 'DYNAMIC',
    'x-robots-tag': 'none',
    server: 'cloudflare'
  },
  requestID: 'req_011CUxoxYnFBmUqyGcn4zRwY',
  error: [Object]
}
 POST /api/search/realtime 500 in 308ms (compile: 6ms, render: 302ms)
   âš ï¸ Real-time search failed: 500 - 401 {"type":"error","error":{"type":"authentication_error","message":"invalid x-api-key"},"request_id":"req_011CUxoxYnFBmUqyGcn4zRwY"}
âš ï¸ EVENTBRITE_API_KEY not configured
ğŸ”Œ Tier 4: External APIs
âš ï¸ VIATOR_API_KEY not configured
âš ï¸ MINDBODY_API_KEY or MINDBODY_SITE_ID not configured
   ğŸ”Œ Searching external APIs for "" in New York
   âœ… Eventbrite: 0 events
   âœ… Viator: 0 experiences
   âœ… ClassPass/Mindbody: 0 classes
   ğŸ”Œ Found 0 events from external APIs
ğŸ’¡ Tier 5: Intelligent recommendations
   ğŸ’¡ Showing personalized recommendations instead
prisma:query SELECT "public"."events"."id", "public"."events"."created_at", "public"."events"."updated_at", "public"."events"."source_url", "public"."events"."title", "public"."events"."city", "public"."events"."start_time", "public"."events"."subtitle", "public"."events"."description", "public"."events"."category"::text, "public"."events"."organizer", "public"."events"."venue_name", "public"."events"."address", "public"."events"."neighborhood", "public"."events"."lat", "public"."events"."lon", "public"."events"."end_time", "public"."events"."timezone", "public"."events"."price_min", "public"."events"."price_max", "public"."events"."currency", "public"."events"."min_age", "public"."events"."tags", "public"."events"."image_url", "public"."events"."booking_url", "public"."events"."accessibility", "public"."events"."view_count", "public"."events"."view_count_24h", "public"."events"."save_count", "public"."events"."save_count_24h", "public"."events"."share_count", "public"."events"."click_count", "public"."events"."source_domain", "public"."events"."checksum", "public"."events"."canonical_url_hash", "public"."events"."venue_id", "public"."events"."source_id" FROM "public"."events" WHERE ("public"."events"."city" = $1 AND "public"."events"."category" IN (CAST($2::text AS "public"."EventCategory"),CAST($3::text AS "public"."EventCategory"),CAST($4::text AS "public"."EventCategory")) AND "public"."events"."start_time" >= $5) ORDER BY "public"."events"."view_count" DESC, "public"."events"."save_count" DESC, "public"."events"."start_time" ASC LIMIT $6 OFFSET $7
âœ… Final: 14 results across all tiers
 GET /api/search?city=New+York&category=FITNESS&limit=20 200 in 465ms (compile: 9ms, render: 456ms)
